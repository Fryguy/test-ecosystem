FROM debian:9 AS debian

RUN apt-get update \
 && apt-get install -y git build-essential pkg-config \
    libpcre3-dev libevent-dev \
    libxml2-dev libyaml-dev libssl-dev zlib1g-dev libsqlite3-dev

ARG crystal_deb
ADD ${crystal_deb} /tmp/crystal.deb
RUN dpkg --force-bad-version -i /tmp/crystal.deb \
 && apt-get install -f

ENV REPOS_DIR /repos
ADD ./setup /setup
RUN /setup/00-install-bats.sh
RUN /setup/10-clone-repos.sh
